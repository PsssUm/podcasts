{"ast":null,"code":"import _objectSpread from \"/Users/spbiphones/Dropbox/projects/web projects/podcasts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/spbiphones/Dropbox/projects/web projects/podcasts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/spbiphones/Dropbox/projects/web projects/podcasts/src/pages/custom_views/WaveFormExample.js\";\nimport React, { useCallback, useEffect, useRef, useState, useMemo } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport styled from \"styled-components\";\nimport { WaveSurfer, WaveForm, Region } from \"wavesurfer-react\";\nimport RegionsPlugin from \"wavesurfer.js/dist/plugin/wavesurfer.regions.min\";\nimport TimelinePlugin from \"wavesurfer.js/dist/plugin/wavesurfer.timeline.min\";\nexport function WaveformExample() {\n  const _useState = useState(true),\n        _useState2 = _slicedToArray(_useState, 2),\n        timelineVis = _useState2[0],\n        setTimelineVis = _useState2[1];\n\n  const plugins = useMemo(() => {\n    return [{\n      plugin: RegionsPlugin,\n      options: {\n        dragSelection: true\n      }\n    }, timelineVis && {\n      plugin: TimelinePlugin,\n      options: {\n        container: \"#timeline\"\n      }\n    }].filter(Boolean);\n  }, [timelineVis]);\n  const toggleTimeline = useCallback(() => {\n    setTimelineVis(!timelineVis);\n  }, [timelineVis]);\n\n  const _useState3 = useState([{\n    id: \"region-1\",\n    start: 0.5,\n    end: 10,\n    color: \"rgba(0, 0, 0, .5)\",\n    data: {\n      systemRegionId: 31\n    }\n  }, {\n    id: \"region-2\",\n    start: 5,\n    end: 25,\n    color: \"rgba(225, 195, 100, .5)\",\n    data: {\n      systemRegionId: 32\n    }\n  }, {\n    id: \"region-3\",\n    start: 15,\n    end: 35,\n    color: \"rgba(25, 95, 195, .5)\",\n    data: {\n      systemRegionId: 33\n    }\n  }]),\n        _useState4 = _slicedToArray(_useState3, 2),\n        regions = _useState4[0],\n        setRegions = _useState4[1]; // use regions ref to pass it inside useCallback\n  // so it will use always the most fresh version of regions list\n\n\n  const regionsRef = useRef(regions);\n  useEffect(() => {\n    regionsRef.current = regions;\n  }, [regions]);\n  const regionCreatedHandler = useCallback(region => {\n    console.log(\"region-created --> region:\", region);\n    if (region.data.systemRegionId) return;\n    setRegions([...regionsRef.current, _objectSpread({}, region, {\n      data: _objectSpread({}, region.data, {\n        systemRegionId: -1\n      })\n    })]);\n  }, [regionsRef]);\n  const wavesurferRef = useRef();\n  const handleWSMount = useCallback(waveSurfer => {\n    wavesurferRef.current = waveSurfer;\n\n    if (wavesurferRef.current) {\n      wavesurferRef.current.load(\"https://www.mfiles.co.uk/mp3-downloads/gs-cd-track2.mp3\");\n      wavesurferRef.current.on(\"region-created\", regionCreatedHandler);\n      wavesurferRef.current.on(\"ready\", () => {\n        console.log(\"WaveSurfer is ready\");\n      });\n      wavesurferRef.current.on(\"region-removed\", region => {\n        console.log(\"region-removed --> \", region);\n      });\n      wavesurferRef.current.on(\"loading\", data => {\n        console.log(\"loading --> \", data);\n      });\n\n      if (window) {\n        window.surferidze = wavesurferRef.current;\n      }\n    }\n  }, [regionCreatedHandler]);\n  const generateRegion = useCallback(() => {\n    if (!wavesurferRef.current) return;\n    const minTimestampInSeconds = 0;\n    const maxTimestampInSeconds = wavesurferRef.current.getDuration();\n    const distance = generateNum(0, 10);\n\n    const _generateTwoNumsWithD = generateTwoNumsWithDistance(distance, minTimestampInSeconds, maxTimestampInSeconds),\n          _generateTwoNumsWithD2 = _slicedToArray(_generateTwoNumsWithD, 2),\n          min = _generateTwoNumsWithD2[0],\n          max = _generateTwoNumsWithD2[1];\n\n    const r = generateNum(0, 255);\n    const g = generateNum(0, 255);\n    const b = generateNum(0, 255);\n    setRegions([...regions, {\n      id: `custom-${generateNum(0, 9999)}`,\n      start: min,\n      end: max,\n      color: `rgba(${r}, ${g}, ${b}, 0.5)`\n    }]);\n  }, [regions, wavesurferRef]);\n  const removeLastRegion = useCallback(() => {\n    let nextRegions = [...regions];\n    nextRegions.pop();\n    setRegions(nextRegions);\n  }, [regions]);\n  const play = useCallback(() => {\n    wavesurferRef.current.playPause();\n  }, []);\n  const handleRegionUpdate = useCallback((region, smth) => {\n    console.log(\"region-update-end --> region:\", region);\n    console.log(smth);\n  }, []);\n  return React.createElement(\"div\", {\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, React.createElement(WaveSurfer, {\n    plugins: plugins,\n    onMount: handleWSMount,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    id: \"timeline\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }), React.createElement(WaveForm, {\n    id: \"waveform\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, regions.map(regionProps => React.createElement(Region, Object.assign({\n    onUpdateEnd: handleRegionUpdate,\n    key: regionProps.id\n  }, regionProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }))))));\n}","map":{"version":3,"sources":["/Users/spbiphones/Dropbox/projects/web projects/podcasts/src/pages/custom_views/WaveFormExample.js"],"names":["React","useCallback","useEffect","useRef","useState","useMemo","ReactDOM","styled","WaveSurfer","WaveForm","Region","RegionsPlugin","TimelinePlugin","WaveformExample","timelineVis","setTimelineVis","plugins","plugin","options","dragSelection","container","filter","Boolean","toggleTimeline","id","start","end","color","data","systemRegionId","regions","setRegions","regionsRef","current","regionCreatedHandler","region","console","log","wavesurferRef","handleWSMount","waveSurfer","load","on","window","surferidze","generateRegion","minTimestampInSeconds","maxTimestampInSeconds","getDuration","distance","generateNum","generateTwoNumsWithDistance","min","max","r","g","b","removeLastRegion","nextRegions","pop","play","playPause","handleRegionUpdate","smth","map","regionProps"],"mappings":"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","sourcesContent":["import React, {\n    useCallback,\n    useEffect,\n    useRef,\n    useState,\n    useMemo\n  } from \"react\";\n  import ReactDOM from \"react-dom\";\n  import styled from \"styled-components\";\n  import { WaveSurfer, WaveForm, Region } from \"wavesurfer-react\";\n  import RegionsPlugin from \"wavesurfer.js/dist/plugin/wavesurfer.regions.min\";\n  import TimelinePlugin from \"wavesurfer.js/dist/plugin/wavesurfer.timeline.min\";\n  \n  \n  export function WaveformExample() {\n    const [timelineVis, setTimelineVis] = useState(true);\n  \n    const plugins = useMemo(() => {\n      return [\n        {\n          plugin: RegionsPlugin,\n          options: { dragSelection: true }\n        },\n        timelineVis && {\n          plugin: TimelinePlugin,\n          options: {\n            container: \"#timeline\"\n          }\n        }\n      ].filter(Boolean);\n    }, [timelineVis]);\n  \n    const toggleTimeline = useCallback(() => {\n      setTimelineVis(!timelineVis);\n    }, [timelineVis]);\n  \n    const [regions, setRegions] = useState([\n      {\n        id: \"region-1\",\n        start: 0.5,\n        end: 10,\n        color: \"rgba(0, 0, 0, .5)\",\n        data: {\n          systemRegionId: 31\n        }\n      },\n      {\n        id: \"region-2\",\n        start: 5,\n        end: 25,\n        color: \"rgba(225, 195, 100, .5)\",\n        data: {\n          systemRegionId: 32\n        }\n      },\n      {\n        id: \"region-3\",\n        start: 15,\n        end: 35,\n        color: \"rgba(25, 95, 195, .5)\",\n        data: {\n          systemRegionId: 33\n        }\n      }\n    ]);\n  \n    // use regions ref to pass it inside useCallback\n    // so it will use always the most fresh version of regions list\n    const regionsRef = useRef(regions);\n  \n    useEffect(() => {\n      regionsRef.current = regions;\n    }, [regions]);\n  \n    const regionCreatedHandler = useCallback(\n      region => {\n        console.log(\"region-created --> region:\", region);\n  \n        if (region.data.systemRegionId) return;\n  \n        setRegions([\n          ...regionsRef.current,\n          { ...region, data: { ...region.data, systemRegionId: -1 } }\n        ]);\n      },\n      [regionsRef]\n    );\n  \n    const wavesurferRef = useRef();\n    const handleWSMount = useCallback(\n      waveSurfer => {\n        wavesurferRef.current = waveSurfer;\n        if (wavesurferRef.current) {\n          wavesurferRef.current.load(\"https://www.mfiles.co.uk/mp3-downloads/gs-cd-track2.mp3\");\n  \n          wavesurferRef.current.on(\"region-created\", regionCreatedHandler);\n  \n          wavesurferRef.current.on(\"ready\", () => {\n            console.log(\"WaveSurfer is ready\");\n          });\n  \n          wavesurferRef.current.on(\"region-removed\", region => {\n            console.log(\"region-removed --> \", region);\n          });\n  \n          wavesurferRef.current.on(\"loading\", data => {\n            console.log(\"loading --> \", data);\n          });\n  \n          if (window) {\n            window.surferidze = wavesurferRef.current;\n          }\n        }\n      },\n      [regionCreatedHandler]\n    );\n  \n    const generateRegion = useCallback(() => {\n      if (!wavesurferRef.current) return;\n      const minTimestampInSeconds = 0;\n      const maxTimestampInSeconds = wavesurferRef.current.getDuration();\n      const distance = generateNum(0, 10);\n      const [min, max] = generateTwoNumsWithDistance(\n        distance,\n        minTimestampInSeconds,\n        maxTimestampInSeconds\n      );\n  \n      const r = generateNum(0, 255);\n      const g = generateNum(0, 255);\n      const b = generateNum(0, 255);\n  \n      setRegions([\n        ...regions,\n        {\n          id: `custom-${generateNum(0, 9999)}`,\n          start: min,\n          end: max,\n          color: `rgba(${r}, ${g}, ${b}, 0.5)`\n        }\n      ]);\n    }, [regions, wavesurferRef]);\n  \n    const removeLastRegion = useCallback(() => {\n      let nextRegions = [...regions];\n  \n      nextRegions.pop();\n  \n      setRegions(nextRegions);\n    }, [regions]);\n  \n    const play = useCallback(() => {\n      wavesurferRef.current.playPause();\n    }, []);\n  \n    const handleRegionUpdate = useCallback((region, smth) => {\n      console.log(\"region-update-end --> region:\", region);\n      console.log(smth);\n    }, []);\n  \n    return (\n      <div className=\"App\">\n        <WaveSurfer plugins={plugins} onMount={handleWSMount}>\n        <div id=\"timeline\" />\n          <WaveForm id=\"waveform\">\n            {regions.map(regionProps => (\n              <Region\n                onUpdateEnd={handleRegionUpdate}\n                key={regionProps.id}\n                {...regionProps}\n              />\n            ))}\n          </WaveForm>\n          \n        </WaveSurfer>\n        \n      </div>\n    );\n  }"]},"metadata":{},"sourceType":"module"}