{"ast":null,"code":"import _classCallCheck from\"/Users/spbiphones/Dropbox/projects/web projects/podcasts/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/spbiphones/Dropbox/projects/web projects/podcasts/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/spbiphones/Dropbox/projects/web projects/podcasts/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/spbiphones/Dropbox/projects/web projects/podcasts/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/spbiphones/Dropbox/projects/web projects/podcasts/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/spbiphones/Dropbox/projects/web projects/podcasts/node_modules/@babel/runtime/helpers/esm/inherits\";import React from\"react\";import{Button}from'@vkontakte/vkui';import'../resources/styles/edit.css';import{View,Panel,Root,PanelHeader}from'@vkontakte/vkui';import play_blue from\"../resources/icons/play_blue.svg\";import pause_gray from\"../resources/icons/pause_gray.svg\";import cut_gray from\"../resources/icons/cut_gray.svg\";import undo_gray from\"../resources/icons/undo_gray.svg\";import music_gray from\"../resources/icons/music_gray.svg\";import music_blue from\"../resources/icons/music_blue.svg\";import volume_grow_gray from\"../resources/icons/volume_grow_gray.svg\";import volume_grow_blue from\"../resources/icons/volume_grow_blue.svg\";import volume_down_gray from\"../resources/icons/volume_down_gray.svg\";import volume_down_blue from\"../resources/icons/volume_down_blue.svg\";import add_circle_24 from\"../resources/icons/add_circle_24.svg\";import{getEpmtyTimecodeModel,convertSecondsToTime}from'../utils/Utils';import TimeCodeItem from'./custom_views/TimeCodeItem';import MusicPicker from'./MusicPicker';import Navbar from'../panels/Navbar';import BottomSheetDialog from'./custom_views/BottomSheetDialog';import styled from\"styled-components\";import RegionsPlugin from\"wavesurfer.js/dist/plugin/wavesurfer.regions.min\";import TimelinePlugin from\"wavesurfer.js/dist/plugin/wavesurfer.timeline.min\";import Waveform from\"./custom_views/Waveform\";import TimelineExample from\"./custom_views/TimeLineExample\";import WaveFormExample from\"./custom_views/WaveFormExample\";import Mp3Cutter from'mp3-cutter';var EditPodcast=/*#__PURE__*/function(_React$Component){_inherits(EditPodcast,_React$Component);function EditPodcast(props){var _this;_classCallCheck(this,EditPodcast);_this=_possibleConstructorReturn(this,_getPrototypeOf(EditPodcast).call(this,props));_this.state={isPlaying:false,isCut:false,isUndo:false,isMusic:false,isGrow:false,isDown:false,timecodes:_this.props.podcast.timecodes,isShowMusicPicker:false,music:undefined,isShowBottomDialog:false,currentTime:0,cutStart:-1,cutEnd:-1,audioSrc:URL.createObjectURL(_this.props.podcast.audioFile)};_this.playClicked=_this.playClicked.bind(_assertThisInitialized(_this));_this.cutClicked=_this.cutClicked.bind(_assertThisInitialized(_this));_this.undoClicked=_this.undoClicked.bind(_assertThisInitialized(_this));_this.musicClicked=_this.musicClicked.bind(_assertThisInitialized(_this));_this.growClicked=_this.growClicked.bind(_assertThisInitialized(_this));_this.downClicked=_this.downClicked.bind(_assertThisInitialized(_this));_this.onSave=_this.onSave.bind(_assertThisInitialized(_this));_this.addTimecode=_this.addTimecode.bind(_assertThisInitialized(_this));_this.onDeleteTimeCode=_this.onDeleteTimeCode.bind(_assertThisInitialized(_this));_this.onTimeCodeTitleChanged=_this.onTimeCodeTitleChanged.bind(_assertThisInitialized(_this));_this.onTimeCodeTimeChanged=_this.onTimeCodeTimeChanged.bind(_assertThisInitialized(_this));_this.toogleMusicPicker=_this.toogleMusicPicker.bind(_assertThisInitialized(_this));_this.onMusicPicked=_this.onMusicPicked.bind(_assertThisInitialized(_this));_this.toogleBottomSheet=_this.toogleBottomSheet.bind(_assertThisInitialized(_this));_this.changeMusic=_this.changeMusic.bind(_assertThisInitialized(_this));_this.removeMusic=_this.removeMusic.bind(_assertThisInitialized(_this));_this.onCloseBottom=_this.onCloseBottom.bind(_assertThisInitialized(_this));_this.onTimeCodeChanged=_this.onTimeCodeChanged.bind(_assertThisInitialized(_this));_this.disableUndo=_this.disableUndo.bind(_assertThisInitialized(_this));_this.onRegionSelected=_this.onRegionSelected.bind(_assertThisInitialized(_this));_this.onCutChanged=_this.onCutChanged.bind(_assertThisInitialized(_this));return _this;}_createClass(EditPodcast,[{key:\"onTimeCodeChanged\",value:function onTimeCodeChanged(time){var currentTime=parseInt(time);if(this.state.currentTime!=currentTime){this.setState({currentTime:currentTime});console.log(\"currentTime = \"+currentTime);}}},{key:\"onCloseBottom\",value:function onCloseBottom(){this.setState({isShowBottomDialog:false});}},{key:\"changeMusic\",value:function changeMusic(){this.setState({isShowMusicPicker:true});}},{key:\"removeMusic\",value:function removeMusic(){this.setState({music:undefined,isMusic:false});}},{key:\"playClicked\",value:function playClicked(){this.setState({isPlaying:!this.state.isPlaying});}},{key:\"cutClicked\",value:function cutClicked(){this.setState({isCut:!this.state.isCut});// if (this.state.isCut && this.state.cutStart != -1){\n//     Mp3Cutter.cut({\n//         src: \"https://www.mfiles.co.uk/mp3-downloads/gs-cd-track2.mp3\",\n//         target: \"asd.mp3\",\n//         start: Number(this.state.cutStart),\n//         end: Number(this.state.cutEnd) \n//     });\n// }\n}},{key:\"undoClicked\",value:function undoClicked(){this.setState({isUndo:true,isDown:false,isGrow:false,isMusic:false});}},{key:\"disableUndo\",value:function disableUndo(){this.setState({isUndo:false});}},{key:\"onRegionSelected\",value:function onRegionSelected(region){this.setState({isCut:true});}},{key:\"musicClicked\",value:function musicClicked(){if(!this.state.isMusic){this.toogleMusicPicker();}else{this.toogleBottomSheet();}}},{key:\"onCutChanged\",value:function onCutChanged(cutStart,cutEnd){this.setState({cutStart:cutStart,cutEnd:cutEnd});}},{key:\"growClicked\",value:function growClicked(){this.setState({isGrow:!this.state.isGrow});}},{key:\"downClicked\",value:function downClicked(){this.setState({isDown:!this.state.isDown});}},{key:\"toogleMusicPicker\",value:function toogleMusicPicker(){this.setState({isShowMusicPicker:!this.state.isShowMusicPicker});}},{key:\"toogleBottomSheet\",value:function toogleBottomSheet(){this.setState({isShowBottomDialog:!this.state.isShowBottomDialog});}},{key:\"onSave\",value:function onSave(){var podcast=this.props.podcast;podcast.timecodes=this.state.timecodes;this.props.setPodcast(podcast);this.props.changePage(\"details\");}},{key:\"addTimecode\",value:function addTimecode(){var newTimeCode=getEpmtyTimecodeModel(convertSecondsToTime(this.state.currentTime));var timecodes=this.state.timecodes;timecodes.push(newTimeCode);this.setState({timecodes:timecodes});}},{key:\"onDeleteTimeCode\",value:function onDeleteTimeCode(timecode){var timecodes=this.state.timecodes;var index=timecodes.indexOf(timecode);if(index>-1){timecodes.splice(index,1);}this.setState({timecodes:timecodes});}},{key:\"onTimeCodeTitleChanged\",value:function onTimeCodeTitleChanged(title,index){var timecodes=this.state.timecodes;var timecode=timecodes[index];timecode.title=title;timecodes[index]=timecode;this.setState({timecodes:timecodes});}},{key:\"onTimeCodeTimeChanged\",value:function onTimeCodeTimeChanged(time,index){var timecodes=this.state.timecodes;var timecode=timecodes[index];timecode.time=time;timecodes[index]=timecode;this.setState({timecodes:timecodes});}},{key:\"onMusicPicked\",value:function onMusicPicked(music){if(music!=undefined){this.setState({isMusic:true});this.setState({music:music,isShowMusicPicker:false});}}},{key:\"render\",value:function render(){var _this2=this;return React.createElement(\"div\",{className:\"main_content bot_margin_64\"},!this.state.isShowMusicPicker&&React.createElement(PanelHeader,null,React.createElement(Navbar,{back:\"details\",onBack:this.props.onBack,title:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\"})),React.createElement(\"div\",{className:\"navbar_line\"}),React.createElement(\"div\",{className:\"wave_container\"},React.createElement(\"div\",{className:\"edit_waves\"},React.createElement(WaveFormExample,{onCutChanged:this.onCutChanged,isDown:this.state.isDown,isGrow:this.state.isGrow,onRegionSelected:this.onRegionSelected,disableUndo:this.disableUndo,isUndo:this.state.isUndo,onTimeCodeChanged:this.onTimeCodeChanged,audioSrc:this.state.audioSrc,isPlaying:this.state.isPlaying,playClicked:this.playClicked})),React.createElement(\"div\",{className:\"space_beetwen_controlls\"},React.createElement(\"img\",{onClick:this.playClicked,className:\"controlls_icon hover\",src:this.state.isPlaying?pause_gray:play_blue}),React.createElement(\"div\",{className:\"flex\"},React.createElement(\"img\",{onClick:this.cutClicked,style:this.state.isCut?{}:{opacity:'0.4'},className:\"controlls_icon controlls_icon_right hover\",src:cut_gray}),React.createElement(\"img\",{onClick:this.undoClicked,className:\"controlls_icon hover\",src:undo_gray})),React.createElement(\"div\",{className:\"flex\"},React.createElement(\"img\",{onClick:this.musicClicked,className:\"controlls_icon controlls_icon_right hover\",src:this.state.isMusic?music_blue:music_gray}),React.createElement(\"img\",{onClick:this.growClicked,className:\"controlls_icon controlls_icon_right hover\",src:this.state.isGrow?volume_grow_blue:volume_grow_gray}),React.createElement(\"img\",{onClick:this.downClicked,className:\"controlls_icon hover\",src:this.state.isDown?volume_down_blue:volume_down_gray})))),React.createElement(\"div\",{className:\"container_edit\"},React.createElement(\"p\",{className:\"timecodes_title\"},\"\\u0422\\u0430\\u0439\\u043C\\u043A\\u043E\\u0434\\u044B\"),this.state.timecodes.length>0&&this.state.timecodes.map(function(item,index){return React.createElement(TimeCodeItem,{onTimeCodeTimeChanged:_this2.onTimeCodeTimeChanged,onTimeCodeTitleChanged:_this2.onTimeCodeTitleChanged,onDeleteTimeCode:_this2.onDeleteTimeCode,index:index,timecode:item,key:index});}),React.createElement(\"div\",{onClick:this.addTimecode,className:\"add_timecode_container hover\"},React.createElement(\"img\",{className:\"add_timecode_icon\",src:add_circle_24}),React.createElement(\"p\",{className:\"add_timecode_text\"},\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0442\\u0430\\u0439\\u043C\\u043A\\u043E\\u0434\"))),React.createElement(\"p\",{className:\"timecodes_description\"},\"\\u041E\\u0442\\u043C\\u0435\\u0442\\u043A\\u0438 \\u0432\\u0440\\u0435\\u043C\\u0435\\u043D\\u0438 \\u0441 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\\u043C \\u0442\\u0435\\u043C\\u044B. \\u041F\\u043E\\u0437\\u0432\\u043E\\u043B\\u044F\\u044E\\u0442 \\u0441\\u043B\\u0443\\u0448\\u0430\\u0442\\u0435\\u043B\\u044F\\u043C \\u043B\\u0435\\u0433\\u0447\\u0435 \\u043F\\u0443\\u0442\\u0435\\u0448\\u0435\\u0441\\u0442\\u0432\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u043E \\u043F\\u043E\\u0434\\u043A\\u0430\\u0441\\u0442\\u0443.\"),React.createElement(\"div\",{className:\"bottom_button_container\"},React.createElement(\"div\",{className:\"bottom_btn_line\"}),React.createElement(\"div\",{onClick:this.onSave,className:\"large_vk_btn hover\"},\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\")),this.state.isShowMusicPicker&&React.createElement(MusicPicker,{onMusicPicked:this.onMusicPicked,onBack:this.toogleMusicPicker,setPodcast:this.setPodcast,podcast:this.state.podcast,changePage:this.changePage}),this.state.isShowBottomDialog&&React.createElement(BottomSheetDialog,{removeMusic:this.removeMusic,changeMusic:this.changeMusic,onClose:this.onCloseBottom}));}}]);return EditPodcast;}(React.Component);export default EditPodcast;","map":{"version":3,"sources":["/Users/spbiphones/Dropbox/projects/web projects/podcasts/src/pages/EditPodcast.js"],"names":["React","Button","View","Panel","Root","PanelHeader","getEpmtyTimecodeModel","convertSecondsToTime","TimeCodeItem","MusicPicker","Navbar","BottomSheetDialog","styled","RegionsPlugin","TimelinePlugin","Waveform","TimelineExample","WaveFormExample","Mp3Cutter","EditPodcast","props","state","isPlaying","isCut","isUndo","isMusic","isGrow","isDown","timecodes","podcast","isShowMusicPicker","music","undefined","isShowBottomDialog","currentTime","cutStart","cutEnd","audioSrc","URL","createObjectURL","audioFile","playClicked","bind","cutClicked","undoClicked","musicClicked","growClicked","downClicked","onSave","addTimecode","onDeleteTimeCode","onTimeCodeTitleChanged","onTimeCodeTimeChanged","toogleMusicPicker","onMusicPicked","toogleBottomSheet","changeMusic","removeMusic","onCloseBottom","onTimeCodeChanged","disableUndo","onRegionSelected","onCutChanged","time","parseInt","setState","console","log","region","setPodcast","changePage","newTimeCode","push","timecode","index","indexOf","splice","title","onBack","pause_gray","play_blue","opacity","cut_gray","undo_gray","music_blue","music_gray","volume_grow_blue","volume_grow_gray","volume_down_blue","volume_down_gray","length","map","item","add_circle_24","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Button} from '@vkontakte/vkui';\nimport '../resources/styles/edit.css'\nimport { View, Panel, Root, PanelHeader } from '@vkontakte/vkui';\nimport play_blue from '../resources/icons/play_blue.svg'\nimport pause_gray from '../resources/icons/pause_gray.svg'\nimport cut_gray from '../resources/icons/cut_gray.svg'\nimport undo_gray from '../resources/icons/undo_gray.svg'\nimport music_gray from '../resources/icons/music_gray.svg'\nimport music_blue from '../resources/icons/music_blue.svg'\nimport volume_grow_gray from '../resources/icons/volume_grow_gray.svg'\nimport volume_grow_blue from '../resources/icons/volume_grow_blue.svg'\nimport volume_down_gray from '../resources/icons/volume_down_gray.svg'\nimport volume_down_blue from '../resources/icons/volume_down_blue.svg'\nimport add_circle_24 from '../resources/icons/add_circle_24.svg'\nimport { getEpmtyTimecodeModel, convertSecondsToTime } from '../utils/Utils';\nimport TimeCodeItem from './custom_views/TimeCodeItem';\nimport MusicPicker from './MusicPicker';\nimport Navbar from '../panels/Navbar';\nimport BottomSheetDialog from './custom_views/BottomSheetDialog';\nimport styled from \"styled-components\";\nimport RegionsPlugin from \"wavesurfer.js/dist/plugin/wavesurfer.regions.min\";\nimport TimelinePlugin from \"wavesurfer.js/dist/plugin/wavesurfer.timeline.min\";\nimport Waveform from \"./custom_views/Waveform\";\nimport TimelineExample from \"./custom_views/TimeLineExample\";\nimport WaveFormExample from \"./custom_views/WaveFormExample\";\nimport Mp3Cutter from 'mp3-cutter'\n \nclass EditPodcast extends React.Component {\n   \n    constructor(props){\n        super(props)\n        this.state = {\n            isPlaying : false,\n            isCut : false,\n            isUndo : false,\n            isMusic : false,\n            isGrow : false,\n            isDown : false,\n            timecodes : this.props.podcast.timecodes,\n            isShowMusicPicker : false,\n            music : undefined,\n            isShowBottomDialog : false,\n            currentTime : 0,\n            cutStart : -1,\n            cutEnd : -1,\n            audioSrc : URL.createObjectURL(this.props.podcast.audioFile)\n        }\n        this.playClicked = this.playClicked.bind(this);\n        this.cutClicked = this.cutClicked.bind(this);\n        this.undoClicked = this.undoClicked.bind(this);\n        this.musicClicked = this.musicClicked.bind(this);\n        this.growClicked = this.growClicked.bind(this);\n        this.downClicked = this.downClicked.bind(this);\n        this.onSave = this.onSave.bind(this);\n        this.addTimecode = this.addTimecode.bind(this);\n        this.onDeleteTimeCode = this.onDeleteTimeCode.bind(this);\n        this.onTimeCodeTitleChanged = this.onTimeCodeTitleChanged.bind(this);\n        this.onTimeCodeTimeChanged = this.onTimeCodeTimeChanged.bind(this);\n        this.toogleMusicPicker = this.toogleMusicPicker.bind(this);\n        this.onMusicPicked = this.onMusicPicked.bind(this);\n        this.toogleBottomSheet = this.toogleBottomSheet.bind(this);\n        this.changeMusic = this.changeMusic.bind(this);\n        this.removeMusic = this.removeMusic.bind(this);\n        this.onCloseBottom = this.onCloseBottom.bind(this);\n        this.onTimeCodeChanged = this.onTimeCodeChanged.bind(this);\n        this.disableUndo = this.disableUndo.bind(this);\n        this.onRegionSelected = this.onRegionSelected.bind(this);\n        this.onCutChanged = this.onCutChanged.bind(this);\n     \n    }\n\n    onTimeCodeChanged(time){\n        var currentTime = parseInt(time)\n        if (this.state.currentTime != currentTime){\n            this.setState({currentTime : currentTime})\n            console.log(\"currentTime = \" + currentTime)\n        }\n\n    }\n    onCloseBottom(){\n        this.setState({isShowBottomDialog : false})\n    }\n    changeMusic(){\n        this.setState({isShowMusicPicker : true})\n    }\n    removeMusic(){\n        this.setState({music : undefined, isMusic : false})\n    }\n    playClicked(){\n        this.setState({isPlaying : !this.state.isPlaying})\n    }\n    cutClicked(){\n        this.setState({isCut : !this.state.isCut})\n        // if (this.state.isCut && this.state.cutStart != -1){\n        //     Mp3Cutter.cut({\n        //         src: \"https://www.mfiles.co.uk/mp3-downloads/gs-cd-track2.mp3\",\n        //         target: \"asd.mp3\",\n        //         start: Number(this.state.cutStart),\n        //         end: Number(this.state.cutEnd) \n        //     });\n        // }\n    }\n    undoClicked(){\n        this.setState({isUndo : true, isDown : false, isGrow : false, isMusic : false})\n    }\n    disableUndo(){\n        this.setState({isUndo : false})\n    }\n    onRegionSelected(region){\n        this.setState({isCut : true})\n    }\n    musicClicked(){\n        if (!this.state.isMusic){\n            this.toogleMusicPicker()\n        } else {\n            this.toogleBottomSheet()\n        }\n        \n    }\n    onCutChanged(cutStart, cutEnd){\n        this.setState({cutStart : cutStart, cutEnd : cutEnd})\n    }\n    growClicked(){\n        this.setState({isGrow : !this.state.isGrow})\n    }\n    downClicked(){\n        this.setState({isDown : !this.state.isDown})\n    }\n    toogleMusicPicker(){\n        this.setState({isShowMusicPicker : !this.state.isShowMusicPicker})\n    }\n    toogleBottomSheet(){\n        this.setState({isShowBottomDialog : !this.state.isShowBottomDialog})\n    }\n    onSave(){\n        var podcast = this.props.podcast\n        podcast.timecodes = this.state.timecodes\n        this.props.setPodcast(podcast)\n        this.props.changePage(\"details\")\n    }\n    addTimecode(){\n        var newTimeCode = getEpmtyTimecodeModel(convertSecondsToTime(this.state.currentTime))\n        var timecodes = this.state.timecodes\n        timecodes.push(newTimeCode)\n        this.setState({timecodes : timecodes})\n    }\n    onDeleteTimeCode(timecode){\n        var timecodes = this.state.timecodes\n        const index = timecodes.indexOf(timecode);\n        if (index > -1) {\n            timecodes.splice(index, 1);\n        }\n        this.setState({timecodes : timecodes})\n    }\n    onTimeCodeTitleChanged(title, index){\n        var timecodes = this.state.timecodes\n        var timecode = timecodes[index]\n        timecode.title = title\n        timecodes[index] = timecode\n        this.setState({timecodes : timecodes})\n    }\n    onTimeCodeTimeChanged(time, index){\n        var timecodes = this.state.timecodes\n        var timecode = timecodes[index]\n        timecode.time = time\n        timecodes[index] = timecode\n        this.setState({timecodes : timecodes})\n    }\n    onMusicPicked(music){\n        if (music != undefined){\n            this.setState({isMusic : true})\n            this.setState({music : music, isShowMusicPicker : false})\n        }\n        \n    }\n    render() {\n        return (\n            <div className=\"main_content bot_margin_64\">\n               {!this.state.isShowMusicPicker && <PanelHeader>\n                    <Navbar back=\"details\" onBack={this.props.onBack} title=\"Редактирование\"/>\n                </PanelHeader>}\n                <div className=\"navbar_line\"/>\n                <div className=\"wave_container\">\n                    <div className=\"edit_waves\">\n                        <WaveFormExample onCutChanged={this.onCutChanged} isDown={this.state.isDown} isGrow={this.state.isGrow} onRegionSelected={this.onRegionSelected} disableUndo={this.disableUndo} isUndo={this.state.isUndo} onTimeCodeChanged={this.onTimeCodeChanged} audioSrc={this.state.audioSrc} isPlaying={this.state.isPlaying} playClicked={this.playClicked}/>\n                    </div>\n                    <div className=\"space_beetwen_controlls\">\n                        <img onClick={this.playClicked} className=\"controlls_icon hover\" src={this.state.isPlaying ? pause_gray : play_blue}/>\n                        <div className=\"flex\">\n                            <img onClick={this.cutClicked} style={this.state.isCut ? {} : {opacity : '0.4'}} className=\"controlls_icon controlls_icon_right hover\" src={cut_gray}/>\n                            <img onClick={this.undoClicked} className=\"controlls_icon hover\" src={undo_gray}/>\n                        </div>\n                        <div className=\"flex\">\n                            <img onClick={this.musicClicked} className=\"controlls_icon controlls_icon_right hover\" src={this.state.isMusic ? music_blue : music_gray}/>\n                            <img onClick={this.growClicked} className=\"controlls_icon controlls_icon_right hover\" src={this.state.isGrow ? volume_grow_blue : volume_grow_gray}/>\n                            <img onClick={this.downClicked} className=\"controlls_icon hover\" src={this.state.isDown ? volume_down_blue : volume_down_gray}/>\n                        </div>\n                    </div>\n\n                </div>\n\n                <div className=\"container_edit\">\n                    <p className=\"timecodes_title\">Таймкоды</p>\n                        {this.state.timecodes.length > 0 && this.state.timecodes.map((item, index) => (\n                            <TimeCodeItem onTimeCodeTimeChanged={this.onTimeCodeTimeChanged} onTimeCodeTitleChanged={this.onTimeCodeTitleChanged} onDeleteTimeCode={this.onDeleteTimeCode} index={index} timecode={item} key={index}/>\n                        ))}\n                    <div onClick={this.addTimecode} className=\"add_timecode_container hover\">\n                        <img className=\"add_timecode_icon\" src={add_circle_24}/>\n                        <p className=\"add_timecode_text\">Добавить таймкод</p>\n                    </div>\n                </div>\n                <p className=\"timecodes_description\">Отметки времени с названием темы. Позволяют слушателям легче путешествовать по подкасту.</p>\n                <div className=\"bottom_button_container\">\n                    <div className=\"bottom_btn_line\"/>\n                    <div onClick={this.onSave} className=\"large_vk_btn hover\">Сохранить</div>\n\n                </div>\n                {this.state.isShowMusicPicker && <MusicPicker onMusicPicked={this.onMusicPicked} onBack={this.toogleMusicPicker} setPodcast={this.setPodcast} podcast={this.state.podcast} changePage={this.changePage}/>}\n                {this.state.isShowBottomDialog && <BottomSheetDialog removeMusic={this.removeMusic} changeMusic={this.changeMusic} onClose={this.onCloseBottom}/>}\n            </div>\n        );\n    }\n}\nexport default EditPodcast;"]},"metadata":{},"sourceType":"module"}