{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(source, true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(source).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from '../../lib/classNames';\nimport animate from '../../lib/animate';\nimport transitionEvents from '../../lib/transitionEvents';\nimport getClassName from '../../helpers/getClassName';\nimport { IOS, ANDROID } from '../../lib/platform';\nimport Touch from '../Touch/Touch';\nimport removeObjectKeys from '../../lib/removeObjectKeys';\nimport { baseClassNames as panelHeaderClasses } from '../PanelHeader/PanelHeader';\nimport withPlatform from '../../hoc/withPlatform';\nexport var transitionStartEventName = 'VKUI:View:transition-start';\nexport var transitionEndEventName = 'VKUI:View:transition-end';\nvar SwipeBackResults;\n\n(function (SwipeBackResults) {\n  SwipeBackResults[SwipeBackResults[\"fail\"] = 1] = \"fail\";\n  SwipeBackResults[SwipeBackResults[\"success\"] = 2] = \"success\";\n})(SwipeBackResults || (SwipeBackResults = {}));\n\nvar scrollsCache = {};\nvar swipeBackExcludedTags = ['input', 'textarea'];\n\nvar View =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(View, _Component);\n\n  function View(props) {\n    var _this;\n\n    _classCallCheck(this, View);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(View).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"refsStore\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"transitionEndHandler\", function (e) {\n      if (!e || ['animation-ios-next-forward', 'animation-ios-prev-back', 'animation-android-next-forward', 'animation-android-prev-back'].indexOf(e.animationName) > -1) {\n        var activePanel = _this.props.activePanel;\n        var isBack = _this.state.isBack;\n        var prevPanel = _this.state.prevPanel;\n\n        _this.document.dispatchEvent(new _this.window.CustomEvent(transitionEndEventName));\n\n        _this.setState({\n          prevPanel: null,\n          nextPanel: null,\n          visiblePanels: [activePanel],\n          activePanel: activePanel,\n          animated: false,\n          isBack: undefined,\n          scrolls: isBack ? removeObjectKeys(_this.state.scrolls, [prevPanel]) : _this.state.scrolls\n        }, function () {\n          isBack && _this.window.scrollTo(0, _this.state.scrolls[activePanel]);\n          _this.props.onTransition && _this.props.onTransition({\n            isBack: isBack,\n            from: prevPanel,\n            to: activePanel\n          });\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"swipingBackTransitionEndHandler\", function (e) {\n      // indexOf because of vendor prefixes in old browsers\n      var target = e.target;\n\n      if (e.propertyName.indexOf('transform') >= 0 && target.classList.contains('View__panel--swipe-back-next')) {\n        switch (_this.state.swipeBackResult) {\n          case SwipeBackResults.fail:\n            _this.onSwipeBackCancel();\n\n            break;\n\n          case SwipeBackResults.success:\n            _this.onSwipeBackSuccess();\n\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onScrollTop\", function () {\n      var activePanel = _this.state.activePanel;\n\n      if (activePanel) {\n        var scrollTop = _this.document.body.scrollTop || _this.document.documentElement.scrollTop;\n\n        if (scrollTop) {\n          animate({\n            duration: 200,\n            timing: function timing(n) {\n              return Math.sqrt(n);\n            },\n            draw: function draw(val) {\n              _this.window.scrollTo(0, scrollTop - val * scrollTop);\n            }\n          });\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onMoveX\", function (e) {\n      if (swipeBackExcludedTags.indexOf(e.originalEvent.target.tagName.toLowerCase()) > -1) {\n        return;\n      }\n\n      var platform = _this.props.platform;\n\n      if (platform === IOS && !_this.context.isWebView && (e.startX <= 70 || e.startX >= _this.window.innerWidth - 70) && !_this.state.browserSwipe) {\n        _this.setState({\n          browserSwipe: true\n        });\n      }\n\n      if (platform === IOS && _this.context.isWebView && _this.props.onSwipeBack) {\n        if (_this.state.animated && e.startX <= 70) {\n          return;\n        }\n\n        if (e.startX <= 70 && !_this.state.swipingBack && _this.props.history.length > 1) {\n          _this.setState({\n            swipingBack: true,\n            swipebackStartX: e.startX,\n            startT: e.startT,\n            swipeBackPrevPanel: _this.state.activePanel,\n            swipeBackNextPanel: _this.props.history.slice(-2)[0],\n            scrolls: _objectSpread({}, _this.state.scrolls, _defineProperty({}, _this.state.activePanel, _this.window.pageYOffset))\n          });\n        }\n\n        if (_this.state.swipingBack) {\n          var swipeBackShift;\n\n          if (e.shiftX < 0) {\n            swipeBackShift = 0;\n          } else if (e.shiftX > _this.window.innerWidth - _this.state.swipebackStartX) {\n            swipeBackShift = _this.window.innerWidth;\n          } else {\n            swipeBackShift = e.shiftX;\n          }\n\n          _this.setState({\n            swipeBackShift: swipeBackShift\n          });\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onEnd\", function () {\n      if (_this.state.swipingBack) {\n        var speed = _this.state.swipeBackShift / (Date.now() - _this.state.startT) * 1000;\n\n        if (_this.state.swipeBackShift === 0) {\n          _this.onSwipeBackCancel();\n        } else if (_this.state.swipeBackShift >= _this.window.innerWidth) {\n          _this.onSwipeBackSuccess();\n        } else if (speed > 250 || _this.state.swipebackStartX + _this.state.swipeBackShift > _this.window.innerWidth / 2) {\n          _this.setState({\n            swipeBackResult: SwipeBackResults.success\n          });\n        } else {\n          _this.setState({\n            swipeBackResult: SwipeBackResults.fail\n          });\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getRef\", function (c) {\n      if (c && c.container && c.id) {\n        var el = c;\n\n        while (el.container) {\n          el = el.container;\n        }\n\n        _this.refsStore[c.id] = el;\n      }\n    });\n\n    _this.state = {\n      scrolls: scrollsCache[props.id] || {},\n      animated: false,\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n      swipingBack: false,\n      swipebackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipeBackResult: null,\n      browserSwipe: false\n    };\n    return _this;\n  }\n\n  _createClass(View, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.props.id) {\n        scrollsCache[this.props.id] = this.state.scrolls;\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n\n      this.props.popout && !prevProps.popout && this.blurActiveElement();\n      this.props.modal && !prevProps.modal && this.blurActiveElement(); // Нужен переход\n\n      if (prevProps.activePanel !== this.props.activePanel && !prevState.swipingBack && !prevState.browserSwipe) {\n        var firstLayer = this.panels.find(function (panel) {\n          return panel.props.id === prevProps.activePanel || panel.props.id === _this2.props.activePanel;\n        });\n        var isBack = firstLayer && firstLayer.props.id === this.props.activePanel;\n        this.blurActiveElement();\n        this.setState({\n          visiblePanels: [prevProps.activePanel, this.props.activePanel],\n          prevPanel: prevProps.activePanel,\n          nextPanel: this.props.activePanel,\n          activePanel: null,\n          animated: true,\n          scrolls: _objectSpread({}, prevState.scrolls, _defineProperty({}, prevProps.activePanel, this.window.pageYOffset)),\n          isBack: isBack\n        });\n      } // Закончилась анимация свайпа назад\n\n\n      if (prevProps.activePanel !== this.props.activePanel && prevState.swipingBack) {\n        var nextPanel = this.props.activePanel;\n        var prevPanel = prevProps.activePanel;\n        this.setState({\n          swipeBackPrevPanel: null,\n          swipeBackNextPanel: null,\n          swipingBack: false,\n          swipeBackResult: null,\n          swipebackStartX: 0,\n          swipeBackShift: 0,\n          activePanel: nextPanel,\n          visiblePanels: [nextPanel],\n          scrolls: removeObjectKeys(prevState.scrolls, [prevState.swipeBackPrevPanel])\n        }, function () {\n          _this2.document.dispatchEvent(new _this2.window.CustomEvent(transitionEndEventName));\n\n          window.scrollTo(0, prevState.scrolls[_this2.state.activePanel]);\n          prevProps.onTransition && prevProps.onTransition({\n            isBack: true,\n            from: prevPanel,\n            to: nextPanel\n          });\n        });\n      }\n\n      var scrolls = this.state.scrolls; // Начался переход\n\n      if (!prevState.animated && this.state.animated) {\n        this.document.dispatchEvent(new this.window.CustomEvent(transitionStartEventName, {\n          detail: {\n            scrolls: scrolls\n          }\n        }));\n        var nextPanelElement = this.pickPanel(this.state.nextPanel);\n        var prevPanelElement = this.pickPanel(this.state.prevPanel);\n        prevPanelElement.scrollTop = scrolls[this.state.prevPanel];\n\n        if (this.state.isBack) {\n          nextPanelElement.scrollTop = scrolls[this.state.nextPanel];\n        }\n\n        this.waitAnimationFinish(this.pickPanel(this.state.isBack ? this.state.prevPanel : this.state.nextPanel), this.transitionEndHandler);\n      } // Начался свайп назад\n\n\n      if (!prevState.swipingBack && this.state.swipingBack) {\n        this.document.dispatchEvent(new this.window.CustomEvent(transitionStartEventName, {\n          detail: {\n            scrolls: scrolls\n          }\n        }));\n        this.props.onSwipeBackStart && this.props.onSwipeBackStart();\n\n        var _nextPanelElement = this.pickPanel(this.state.swipeBackNextPanel);\n\n        var _prevPanelElement = this.pickPanel(this.state.swipeBackPrevPanel);\n\n        _nextPanelElement.scrollTop = scrolls[this.state.swipeBackNextPanel];\n        _prevPanelElement.scrollTop = scrolls[this.state.swipeBackPrevPanel];\n      } // Началась анимация завершения свайпа назад.\n\n\n      if (!prevState.swipeBackResult && this.state.swipeBackResult) {\n        this.waitTransitionFinish(this.pickPanel(this.state.swipeBackNextPanel), this.swipingBackTransitionEndHandler);\n      } // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n\n\n      if (prevState.swipeBackResult === SwipeBackResults.fail && !this.state.swipeBackResult) {\n        this.window.scrollTo(0, scrolls[this.state.activePanel]);\n      } // Закончился Safari свайп\n\n\n      if (prevProps.activePanel !== this.props.activePanel && this.state.browserSwipe) {\n        this.setState({\n          browserSwipe: false,\n          nextPanel: null,\n          prevPanel: null,\n          animated: false,\n          visiblePanels: [this.props.activePanel],\n          activePanel: this.props.activePanel\n        });\n      }\n    }\n  }, {\n    key: \"waitTransitionFinish\",\n    value: function waitTransitionFinish(elem, eventHandler) {\n      if (transitionEvents.supported) {\n        var eventName = transitionEvents.prefix ? transitionEvents.prefix + 'TransitionEnd' : 'transitionend';\n        elem.removeEventListener(eventName, eventHandler);\n        elem.addEventListener(eventName, eventHandler);\n      } else {\n        setTimeout(function () {\n          return eventHandler();\n        }, this.props.platform === ANDROID ? 300 : 600);\n      }\n    }\n  }, {\n    key: \"waitAnimationFinish\",\n    value: function waitAnimationFinish(elem, eventHandler) {\n      if (transitionEvents.supported) {\n        var eventName = transitionEvents.prefix ? transitionEvents.prefix + 'AnimationEnd' : 'animationend';\n        elem.removeEventListener(eventName, eventHandler);\n        elem.addEventListener(eventName, eventHandler);\n      } else {\n        setTimeout(function () {\n          return eventHandler();\n        }, this.props.platform === ANDROID ? 300 : 600);\n      }\n    }\n  }, {\n    key: \"blurActiveElement\",\n    value: function blurActiveElement() {\n      if (typeof this.window !== 'undefined' && this.document.activeElement) {\n        this.document.activeElement.blur();\n      }\n    }\n  }, {\n    key: \"pickPanel\",\n    value: function pickPanel(id) {\n      var elem = this.document.getElementById(id);\n\n      if (!elem) {\n        console.warn(\"Element #\".concat(id, \" not found\"));\n      }\n\n      return elem && elem.parentNode.parentNode;\n    }\n  }, {\n    key: \"onSwipeBackSuccess\",\n    value: function onSwipeBackSuccess() {\n      this.props.onSwipeBack && this.props.onSwipeBack();\n    }\n  }, {\n    key: \"onSwipeBackCancel\",\n    value: function onSwipeBackCancel() {\n      var _this3 = this;\n\n      this.setState({\n        swipeBackPrevPanel: null,\n        swipeBackNextPanel: null,\n        swipingBack: false,\n        swipeBackResult: null,\n        swipebackStartX: 0,\n        swipeBackShift: 0\n      }, function () {\n        _this3.document.dispatchEvent(new _this3.window.CustomEvent(transitionEndEventName));\n      });\n    }\n  }, {\n    key: \"calcPanelSwipeStyles\",\n    value: function calcPanelSwipeStyles(panelId) {\n      var isPrev = panelId === this.state.swipeBackPrevPanel;\n      var isNext = panelId === this.state.swipeBackNextPanel;\n\n      if (!isPrev && !isNext || this.state.swipeBackResult) {\n        return {};\n      }\n\n      var prevPanelTranslate = \"\".concat(this.state.swipeBackShift, \"px\");\n      var nextPanelTranslate = \"\".concat(-50 + this.state.swipeBackShift * 100 / this.window.innerWidth / 2, \"%\");\n      var prevPanelShadow = 0.3 * (this.window.innerWidth - this.state.swipeBackShift) / this.window.innerWidth;\n\n      if (this.state.swipeBackResult) {\n        return isPrev ? {\n          boxShadow: \"-2px 0 12px rgba(0, 0, 0, \".concat(prevPanelShadow, \")\")\n        } : {};\n      }\n\n      if (isNext) {\n        return {\n          transform: \"translate3d(\".concat(nextPanelTranslate, \", 0, 0)\"),\n          WebkitTransform: \"translate3d(\".concat(nextPanelTranslate, \", 0, 0)\")\n        };\n      }\n\n      if (isPrev) {\n        return {\n          transform: \"translate3d(\".concat(prevPanelTranslate, \", 0, 0)\"),\n          WebkitTransform: \"translate3d(\".concat(prevPanelTranslate, \", 0, 0)\"),\n          boxShadow: \"-2px 0 12px rgba(0, 0, 0, \".concat(prevPanelShadow, \")\")\n        };\n      }\n\n      return {};\n    }\n  }, {\n    key: \"calcHeaderSwipeStyles\",\n    value: function calcHeaderSwipeStyles(panelId) {\n      var isPrev = panelId === this.state.swipeBackPrevPanel;\n      var isNext = panelId === this.state.swipeBackNextPanel;\n\n      if (!isPrev && !isNext || this.state.swipeBackResult !== null) {\n        return {\n          title: {},\n          bg: {},\n          left: {},\n          addon: {},\n          right: {}\n        };\n      }\n\n      var opacity = this.state.swipeBackShift / this.window.innerWidth;\n      var titleTransform = this.state.swipeBackShift / this.window.innerWidth * 30;\n      var leftTransform = this.state.swipeBackShift / this.window.innerWidth * 30;\n\n      if (isNext) {\n        return {\n          title: {\n            transform: \"translate3d(\".concat(-30 + titleTransform, \"vw, 0, 0)\"),\n            WebkitTransform: \"translate3d(\".concat(-30 + titleTransform, \"vw, 0, 0)\"),\n            opacity: opacity\n          },\n          left: {\n            opacity: opacity\n          },\n          addon: {\n            opacity: 1,\n            transform: \"translate3d(\".concat(-30 + leftTransform, \"vw, 0, 0)\"),\n            WebkitTransform: \"translate3d(\".concat(-30 + leftTransform, \"vw, 0, 0)\")\n          },\n          right: {\n            opacity: opacity\n          }\n        };\n      }\n\n      if (isPrev) {\n        return {\n          title: {\n            transform: \"translate3d(\".concat(titleTransform, \"vw, 0, 0)\"),\n            WebkitTransform: \"translate3d(\".concat(titleTransform, \"vw, 0, 0)\"),\n            opacity: 1 - opacity\n          },\n          bg: {\n            opacity: 1 - opacity\n          },\n          left: {\n            opacity: 1 - opacity\n          },\n          addon: {\n            transform: \"translate3d(\".concat(leftTransform, \"vw, 0, 0)\"),\n            WebkitTransform: \"translate3d(\".concat(leftTransform, \"vw, 0, 0)\"),\n            opacity: 1 - opacity\n          }\n        };\n      }\n\n      return {};\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$props = this.props,\n          style = _this$props.style,\n          popout = _this$props.popout,\n          modal = _this$props.modal,\n          header = _this$props.header,\n          platform = _this$props.platform;\n      var _this$state = this.state,\n          prevPanel = _this$state.prevPanel,\n          nextPanel = _this$state.nextPanel,\n          activePanel = _this$state.activePanel,\n          swipeBackPrevPanel = _this$state.swipeBackPrevPanel,\n          swipeBackNextPanel = _this$state.swipeBackNextPanel,\n          swipeBackResult = _this$state.swipeBackResult;\n      var hasPopout = !!popout;\n      var hasModal = !!modal;\n      var panels = this.panels.filter(function (panel) {\n        var panelId = panel.props.id;\n        return _this4.state.visiblePanels.indexOf(panelId) > -1 || panelId === swipeBackPrevPanel || panelId === swipeBackNextPanel;\n      });\n      var modifiers = {\n        'View--header': header,\n        'View--animated': this.state.animated,\n        'View--swiping-back': this.state.swipingBack\n      };\n      return React.createElement(Touch, {\n        component: \"section\",\n        className: classNames(getClassName('View', platform), this.props.className, modifiers),\n        style: style,\n        onMoveX: this.onMoveX,\n        onEnd: this.onEnd\n      }, header && React.createElement(\"div\", {\n        className: \"View__header\"\n      }, platform === IOS && React.createElement(\"div\", {\n        className: \"View__header-scrolltop\",\n        onClick: this.onScrollTop\n      }), React.createElement(\"div\", {\n        className: classNames(panelHeaderClasses)\n      }, panels.map(function (panel) {\n        var panelId = panel.props.id;\n\n        var headerSwipeStyles = _this4.calcHeaderSwipeStyles(panelId);\n\n        return React.createElement(\"div\", {\n          className: classNames('PanelHeader__in', {\n            'PanelHeader__in--active': panelId === activePanel,\n            'PanelHeader__in--prev': panelId === prevPanel,\n            'PanelHeader__in--next': panelId === nextPanel,\n            'PanelHeader__in--swipe-back-prev': panelId === swipeBackPrevPanel,\n            'PanelHeader__in--swipe-back-next': panelId === swipeBackNextPanel,\n            'PanelHeader__in--swipe-back-success': swipeBackResult === SwipeBackResults.success,\n            'PanelHeader__in--swipe-back-failed': swipeBackResult === SwipeBackResults.fail\n          }),\n          key: panelId,\n          id: \"panel-header-\".concat(panelId)\n        }, React.createElement(\"div\", {\n          className: \"PanelHeader__bg\",\n          key: panelId,\n          id: \"header-bg-\".concat(panelId),\n          style: headerSwipeStyles.bg\n        }), React.createElement(\"div\", {\n          className: \"PanelHeader__container\"\n        }, React.createElement(\"div\", {\n          className: \"PanelHeader__left\"\n        }, React.createElement(\"div\", {\n          className: \"PanelHeader__left-in\",\n          id: \"header-left-\".concat(panelId),\n          style: headerSwipeStyles.left\n        }), platform === IOS && React.createElement(\"div\", {\n          className: \"PanelHeader__addon\",\n          id: \"header-addon-\".concat(panelId),\n          style: headerSwipeStyles.addon\n        })), React.createElement(\"div\", {\n          className: \"PanelHeader__content\",\n          style: headerSwipeStyles.title,\n          id: \"header-title-\".concat(panelId)\n        }), React.createElement(\"div\", {\n          className: \"PanelHeader__right\",\n          id: \"header-right-\".concat(panelId),\n          style: headerSwipeStyles.right\n        })));\n      }))), React.createElement(\"div\", {\n        className: \"View__panels\"\n      }, panels.map(function (panel) {\n        var panelId = panel.props.id;\n        return React.createElement(\"div\", {\n          className: classNames('View__panel', {\n            'View__panel--active': panelId === activePanel,\n            'View__panel--prev': panelId === prevPanel,\n            'View__panel--next': panelId === nextPanel,\n            'View__panel--swipe-back-prev': panelId === swipeBackPrevPanel,\n            'View__panel--swipe-back-next': panelId === swipeBackNextPanel,\n            'View__panel--swipe-back-success': swipeBackResult === SwipeBackResults.success,\n            'View__panel--swipe-back-failed': swipeBackResult === SwipeBackResults.fail\n          }),\n          style: _this4.calcPanelSwipeStyles(panelId),\n          key: panelId\n        }, React.createElement(\"div\", {\n          className: \"View__panel-in\"\n        }, panel));\n      })), hasPopout && React.createElement(\"div\", {\n        className: \"View__popout\"\n      }, popout), hasModal && React.createElement(\"div\", {\n        className: \"View__modal\"\n      }, modal));\n    }\n  }, {\n    key: \"document\",\n    get: function get() {\n      return this.context.document || document;\n    }\n  }, {\n    key: \"window\",\n    get: function get() {\n      return this.context.window || window;\n    }\n  }, {\n    key: \"panels\",\n    get: function get() {\n      return [].concat(this.props.children);\n    }\n  }]);\n\n  return View;\n}(Component);\n\n_defineProperty(View, \"defaultProps\", {\n  header: true,\n  history: []\n});\n\n_defineProperty(View, \"contextTypes\", {\n  isWebView: PropTypes.bool,\n  window: PropTypes.any,\n  document: PropTypes.any\n});\n\nexport default withPlatform(View);","map":{"version":3,"sources":["../../../../src/components/View/View.tsx"],"names":["baseClassNames","transitionStartEventName","transitionEndEventName","SwipeBackResults","scrollsCache","swipeBackExcludedTags","View","Component","scrolls","props","animated","visiblePanels","activePanel","isBack","prevPanel","nextPanel","swipingBack","swipebackStartX","swipeBackShift","swipeBackNextPanel","swipeBackPrevPanel","swipeBackResult","browserSwipe","header","history","isWebView","PropTypes","window","document","any","prevProps","prevState","firstLayer","panel","removeObjectKeys","from","to","detail","nextPanelElement","prevPanelElement","elem","eventHandler","transitionEvents","eventName","setTimeout","id","console","e","target","scrollTop","animate","duration","timing","Math","draw","val","platform","startT","speed","Date","success","fail","c","el","panelId","isPrev","isNext","prevPanelTranslate","nextPanelTranslate","prevPanelShadow","boxShadow","transform","WebkitTransform","title","bg","left","addon","right","opacity","titleTransform","leftTransform","style","popout","modal","hasPopout","hasModal","panels","modifiers","classNames","getClassName","onEnd","onScrollTop","headerSwipeStyles","withPlatform"],"mappings":"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","sourcesContent":["import React, { Component, CSSProperties, HTMLAttributes, ReactNode } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from '../../lib/classNames';\nimport animate from '../../lib/animate';\nimport transitionEvents from '../../lib/transitionEvents';\nimport getClassName from '../../helpers/getClassName';\nimport { IOS, ANDROID } from '../../lib/platform';\nimport Touch from '../Touch/Touch';\nimport removeObjectKeys from '../../lib/removeObjectKeys';\nimport { baseClassNames as panelHeaderClasses } from '../PanelHeader/PanelHeader';\nimport { HasChildren, HasPlatform } from '../../types/props';\nimport withPlatform from '../../hoc/withPlatform';\n\nexport const transitionStartEventName = 'VKUI:View:transition-start';\nexport const transitionEndEventName = 'VKUI:View:transition-end';\n\nenum SwipeBackResults { fail = 1, success}\n\ninterface Scrolls {\n  [index: string]: number\n}\n\ninterface ViewsScrolls {\n  [index: string]: Scrolls\n}\n\ninterface AnimationEventHandler {\n  (e?: AnimationEvent): void\n}\n\ninterface TransitionEventHandler {\n  (e?: TransitionEvent): void\n}\n\ninterface HeaderSwipeStyles {\n  title?: CSSProperties;\n  bg?: CSSProperties;\n  left?: CSSProperties;\n  addon?: CSSProperties;\n  right?: CSSProperties;\n}\n\nlet scrollsCache:ViewsScrolls = {};\n\nconst swipeBackExcludedTags = ['input', 'textarea'];\n\nexport interface ViewProps extends HTMLAttributes<HTMLElement>, HasChildren, HasPlatform {\n  activePanel: string\n  header?: boolean;\n  popout?: ReactNode;\n  modal?: ReactNode;\n  onTransition?(params: { isBack: boolean, from: string, to: string }): void;\n  onSwipeBack?(): void;\n  onSwipeBackStart?(): void;\n  history?: string[];\n  id?: string;\n}\n\nexport interface ViewState {\n  scrolls: Scrolls;\n  animated: boolean;\n  startT?: number,\n\n  visiblePanels: string[];\n  activePanel: string;\n  isBack: boolean;\n  prevPanel: string;\n  nextPanel: string;\n\n  swipingBack: boolean;\n  swipebackStartX: number;\n  swipeBackShift: number;\n  swipeBackNextPanel: string;\n  swipeBackPrevPanel: string;\n  swipeBackResult: SwipeBackResults;\n\n  browserSwipe: boolean;\n}\n\nclass View extends Component<ViewProps, ViewState> {\n  constructor (props) {\n    super(props);\n    this.state = {\n      scrolls: scrollsCache[props.id] || {},\n      animated: false,\n\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n\n      swipingBack: false,\n      swipebackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipeBackResult: null,\n\n      browserSwipe: false\n    };\n  }\n\n  static defaultProps = {\n    header: true,\n    history: []\n  };\n\n  static contextTypes = {\n    isWebView: PropTypes.bool,\n    window: PropTypes.any,\n    document: PropTypes.any\n  };\n\n  get document () {\n    return this.context.document || document;\n  }\n\n  get window () {\n    return this.context.window || window;\n  }\n\n  get panels () {\n    return [].concat(this.props.children);\n  }\n\n  refsStore = {};\n\n  componentWillUnmount () {\n    if (this.props.id) {\n      scrollsCache[this.props.id] = this.state.scrolls;\n    }\n  }\n\n  componentDidUpdate (prevProps, prevState) {\n    this.props.popout && !prevProps.popout && this.blurActiveElement();\n    this.props.modal && !prevProps.modal && this.blurActiveElement();\n\n    // Нужен переход\n    if (prevProps.activePanel !== this.props.activePanel && !prevState.swipingBack && !prevState.browserSwipe) {\n      const firstLayer = this.panels.find(\n        panel => panel.props.id === prevProps.activePanel || panel.props.id === this.props.activePanel\n      );\n\n      const isBack = firstLayer && firstLayer.props.id === this.props.activePanel;\n\n      this.blurActiveElement();\n\n      this.setState({\n        visiblePanels: [prevProps.activePanel, this.props.activePanel],\n        prevPanel: prevProps.activePanel,\n        nextPanel: this.props.activePanel,\n        activePanel: null,\n        animated: true,\n        scrolls: {\n          ...prevState.scrolls,\n          [prevProps.activePanel]: this.window.pageYOffset\n        },\n        isBack\n      });\n    }\n\n    // Закончилась анимация свайпа назад\n    if (prevProps.activePanel !== this.props.activePanel && prevState.swipingBack) {\n      const nextPanel = this.props.activePanel;\n      const prevPanel = prevProps.activePanel;\n      this.setState({\n        swipeBackPrevPanel: null,\n        swipeBackNextPanel: null,\n        swipingBack: false,\n        swipeBackResult: null,\n        swipebackStartX: 0,\n        swipeBackShift: 0,\n        activePanel: nextPanel,\n        visiblePanels: [nextPanel],\n        scrolls: removeObjectKeys(prevState.scrolls, [prevState.swipeBackPrevPanel])\n      }, () => {\n        this.document.dispatchEvent(new this.window.CustomEvent(transitionEndEventName));\n        window.scrollTo(0, prevState.scrolls[this.state.activePanel]);\n        prevProps.onTransition && prevProps.onTransition({ isBack: true, from: prevPanel, to: nextPanel });\n      });\n    }\n\n    const scrolls = this.state.scrolls;\n\n    // Начался переход\n    if (!prevState.animated && this.state.animated) {\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionStartEventName, { detail: { scrolls } }));\n      const nextPanelElement = this.pickPanel(this.state.nextPanel);\n      const prevPanelElement = this.pickPanel(this.state.prevPanel);\n\n      prevPanelElement.scrollTop = scrolls[this.state.prevPanel];\n      if (this.state.isBack) {\n        nextPanelElement.scrollTop = scrolls[this.state.nextPanel];\n      }\n      this.waitAnimationFinish(this.pickPanel(this.state.isBack ? this.state.prevPanel : this.state.nextPanel), this.transitionEndHandler);\n    }\n\n    // Начался свайп назад\n    if (!prevState.swipingBack && this.state.swipingBack) {\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionStartEventName, { detail: { scrolls } }));\n      this.props.onSwipeBackStart && this.props.onSwipeBackStart();\n      const nextPanelElement = this.pickPanel(this.state.swipeBackNextPanel);\n      const prevPanelElement = this.pickPanel(this.state.swipeBackPrevPanel);\n\n      nextPanelElement.scrollTop = scrolls[this.state.swipeBackNextPanel];\n      prevPanelElement.scrollTop = scrolls[this.state.swipeBackPrevPanel];\n    }\n\n    // Началась анимация завершения свайпа назад.\n    if (!prevState.swipeBackResult && this.state.swipeBackResult) {\n      this.waitTransitionFinish(this.pickPanel(this.state.swipeBackNextPanel), this.swipingBackTransitionEndHandler);\n    }\n\n    // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n    if (prevState.swipeBackResult === SwipeBackResults.fail && !this.state.swipeBackResult) {\n      this.window.scrollTo(0, scrolls[this.state.activePanel]);\n    }\n\n    // Закончился Safari свайп\n    if (prevProps.activePanel !== this.props.activePanel && this.state.browserSwipe) {\n      this.setState({\n        browserSwipe: false,\n        nextPanel: null,\n        prevPanel: null,\n        animated: false,\n        visiblePanels: [this.props.activePanel],\n        activePanel: this.props.activePanel\n      });\n    }\n  }\n\n  waitTransitionFinish(elem: HTMLElement, eventHandler: TransitionEventHandler): void {\n    if (transitionEvents.supported) {\n      const eventName = transitionEvents.prefix ? transitionEvents.prefix + 'TransitionEnd' : 'transitionend';\n\n      elem.removeEventListener(eventName, eventHandler);\n      elem.addEventListener(eventName, eventHandler);\n    } else {\n      setTimeout(() => eventHandler(), this.props.platform === ANDROID ? 300 : 600);\n    }\n  }\n\n  waitAnimationFinish(elem: HTMLElement, eventHandler: AnimationEventHandler): void {\n    if (transitionEvents.supported) {\n      const eventName = transitionEvents.prefix ? transitionEvents.prefix + 'AnimationEnd' : 'animationend';\n\n      elem.removeEventListener(eventName, eventHandler);\n      elem.addEventListener(eventName, eventHandler);\n    } else {\n      setTimeout(() => eventHandler(), this.props.platform === ANDROID ? 300 : 600);\n    }\n  }\n\n  blurActiveElement(): void {\n    if (typeof this.window !== 'undefined' && this.document.activeElement) {\n      this.document.activeElement.blur();\n    }\n  }\n\n  pickPanel(id: string): HTMLElement {\n    const elem = this.document.getElementById(id);\n\n    if (!elem) {\n      console.warn(`Element #${id} not found`);\n    }\n\n    return elem && elem.parentNode.parentNode;\n  }\n\n  transitionEndHandler = (e?: AnimationEvent): void => {\n    if (!e || [\n      'animation-ios-next-forward',\n      'animation-ios-prev-back',\n      'animation-android-next-forward',\n      'animation-android-prev-back'\n    ].indexOf(e.animationName) > -1) {\n      const activePanel = this.props.activePanel;\n      const isBack = this.state.isBack;\n      const prevPanel = this.state.prevPanel;\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionEndEventName));\n      this.setState({\n        prevPanel: null,\n        nextPanel: null,\n        visiblePanels: [activePanel],\n        activePanel: activePanel,\n        animated: false,\n        isBack: undefined,\n        scrolls: isBack ? removeObjectKeys(this.state.scrolls, [prevPanel]) : this.state.scrolls\n      }, () => {\n        isBack && this.window.scrollTo(0, this.state.scrolls[activePanel]);\n        this.props.onTransition && this.props.onTransition({ isBack, from: prevPanel, to: activePanel });\n      });\n    }\n  };\n\n  swipingBackTransitionEndHandler = (e?: TransitionEvent): void => {\n    // indexOf because of vendor prefixes in old browsers\n    const target = e.target as HTMLElement;\n    if (e.propertyName.indexOf('transform') >= 0 && target.classList.contains('View__panel--swipe-back-next')) {\n      switch (this.state.swipeBackResult) {\n        case SwipeBackResults.fail:\n          this.onSwipeBackCancel();\n          break;\n        case SwipeBackResults.success:\n          this.onSwipeBackSuccess();\n      }\n    }\n  };\n\n  onSwipeBackSuccess(): void {\n    this.props.onSwipeBack && this.props.onSwipeBack();\n  }\n\n  onSwipeBackCancel(): void {\n    this.setState({\n      swipeBackPrevPanel: null,\n      swipeBackNextPanel: null,\n      swipingBack: false,\n      swipeBackResult: null,\n      swipebackStartX: 0,\n      swipeBackShift: 0\n    }, () => {\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionEndEventName));\n    });\n  }\n\n  onScrollTop = (): void => {\n    const { activePanel } = this.state;\n\n    if (activePanel) {\n      const scrollTop = this.document.body.scrollTop || this.document.documentElement.scrollTop;\n\n      if (scrollTop) {\n        animate({\n          duration: 200,\n          timing: n => Math.sqrt(n),\n          draw: (val) => {\n            this.window.scrollTo(0, scrollTop - val * scrollTop);\n          }\n        });\n      }\n    }\n  };\n\n  onMoveX = (e): void => {\n    if (swipeBackExcludedTags.indexOf(e.originalEvent.target.tagName.toLowerCase()) > -1) {\n      return;\n    }\n\n    const { platform } = this.props;\n\n    if (platform === IOS && !this.context.isWebView && (e.startX <= 70 || e.startX >= this.window.innerWidth - 70) && !this.state.browserSwipe) {\n      this.setState({ browserSwipe: true });\n    }\n\n    if (platform === IOS && this.context.isWebView && this.props.onSwipeBack) {\n      if (this.state.animated && e.startX <= 70) {\n        return;\n      }\n\n      if (e.startX <= 70 && !this.state.swipingBack && this.props.history.length > 1) {\n        this.setState({\n          swipingBack: true,\n          swipebackStartX: e.startX,\n          startT: e.startT,\n          swipeBackPrevPanel: this.state.activePanel,\n          swipeBackNextPanel: this.props.history.slice(-2)[0],\n          scrolls: {\n            ...this.state.scrolls,\n            [this.state.activePanel]: this.window.pageYOffset\n          }\n        });\n      }\n      if (this.state.swipingBack) {\n        let swipeBackShift;\n        if (e.shiftX < 0) {\n          swipeBackShift = 0;\n        } else if (e.shiftX > this.window.innerWidth - this.state.swipebackStartX) {\n          swipeBackShift = this.window.innerWidth;\n        } else {\n          swipeBackShift = e.shiftX;\n        }\n        this.setState({ swipeBackShift });\n      }\n    }\n  };\n\n  onEnd = (): void => {\n    if (this.state.swipingBack) {\n      const speed = this.state.swipeBackShift / (Date.now() - this.state.startT) * 1000;\n      if (this.state.swipeBackShift === 0) {\n        this.onSwipeBackCancel();\n      } else if (this.state.swipeBackShift >= this.window.innerWidth) {\n        this.onSwipeBackSuccess();\n      } else if (speed > 250 || this.state.swipebackStartX + this.state.swipeBackShift > this.window.innerWidth / 2) {\n        this.setState({ swipeBackResult: SwipeBackResults.success });\n      } else {\n        this.setState({ swipeBackResult: SwipeBackResults.fail });\n      }\n    }\n  };\n\n  getRef = (c): void => {\n    if (c && c.container && c.id) {\n      let el = c;\n\n      while (el.container) {\n        el = el.container;\n      }\n\n      this.refsStore[c.id] = el;\n    }\n  };\n\n  calcPanelSwipeStyles(panelId: string): CSSProperties {\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if (!isPrev && !isNext || this.state.swipeBackResult) {\n      return {};\n    }\n\n    let prevPanelTranslate = `${this.state.swipeBackShift}px`;\n    let nextPanelTranslate = `${-50 + (this.state.swipeBackShift * 100 / this.window.innerWidth) / 2}%`;\n    let prevPanelShadow = 0.3 * (this.window.innerWidth - this.state.swipeBackShift) / this.window.innerWidth;\n\n    if (this.state.swipeBackResult) {\n      return isPrev ? { boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})` } : {};\n    }\n\n    if (isNext) {\n      return {\n        transform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${nextPanelTranslate}, 0, 0)`\n      };\n    }\n    if (isPrev) {\n      return {\n        transform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})`\n      };\n    }\n\n    return {};\n  }\n\n  calcHeaderSwipeStyles(panelId: string): HeaderSwipeStyles {\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if (!isPrev && !isNext || this.state.swipeBackResult !== null) {\n      return {\n        title: {},\n        bg: {},\n        left: {},\n        addon: {},\n        right: {}\n      };\n    }\n\n    let opacity = this.state.swipeBackShift / this.window.innerWidth;\n    let titleTransform = this.state.swipeBackShift / this.window.innerWidth * 30;\n    let leftTransform = this.state.swipeBackShift / this.window.innerWidth * 30;\n\n    if (isNext) {\n      return {\n        title: {\n          transform: `translate3d(${-30 + titleTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${-30 + titleTransform}vw, 0, 0)`,\n          opacity\n        },\n        left: { opacity },\n        addon: {\n          opacity: 1,\n          transform: `translate3d(${-30 + leftTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${-30 + leftTransform}vw, 0, 0)`\n        },\n        right: { opacity }\n      };\n    }\n    if (isPrev) {\n      return {\n        title: {\n          transform: `translate3d(${titleTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${titleTransform}vw, 0, 0)`,\n          opacity: 1 - opacity\n        },\n        bg: { opacity: 1 - opacity },\n        left: { opacity: 1 - opacity },\n        addon: {\n          transform: `translate3d(${leftTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${leftTransform}vw, 0, 0)`,\n          opacity: 1 - opacity\n        }\n      };\n    }\n\n    return {};\n  }\n\n  render() {\n    const { style, popout, modal, header, platform } = this.props;\n    const { prevPanel, nextPanel, activePanel, swipeBackPrevPanel, swipeBackNextPanel, swipeBackResult } = this.state;\n\n    const hasPopout = !!popout;\n    const hasModal = !!modal;\n\n    const panels = this.panels.filter(panel => {\n      const panelId = panel.props.id;\n\n      return this.state.visiblePanels.indexOf(panelId) > -1 ||\n        panelId === swipeBackPrevPanel ||\n        panelId === swipeBackNextPanel;\n    });\n\n    const modifiers = {\n      'View--header': header,\n      'View--animated': this.state.animated,\n      'View--swiping-back': this.state.swipingBack\n    };\n\n    return (\n      <Touch\n        component=\"section\"\n        className={classNames(getClassName('View', platform), this.props.className, modifiers)}\n        style={style}\n        onMoveX={this.onMoveX}\n        onEnd={this.onEnd}\n      >\n        {header && (\n          <div className=\"View__header\">\n            {platform === IOS && <div className=\"View__header-scrolltop\" onClick={this.onScrollTop} />}\n            <div className={classNames(panelHeaderClasses)}>\n              {panels.map(panel => {\n                const panelId = panel.props.id;\n                const headerSwipeStyles = this.calcHeaderSwipeStyles(panelId);\n\n                return (\n                  <div\n                    className={classNames('PanelHeader__in', {\n                      'PanelHeader__in--active': panelId === activePanel,\n                      'PanelHeader__in--prev': panelId === prevPanel,\n                      'PanelHeader__in--next': panelId === nextPanel,\n                      'PanelHeader__in--swipe-back-prev': panelId === swipeBackPrevPanel,\n                      'PanelHeader__in--swipe-back-next': panelId === swipeBackNextPanel,\n                      'PanelHeader__in--swipe-back-success': swipeBackResult === SwipeBackResults.success,\n                      'PanelHeader__in--swipe-back-failed': swipeBackResult === SwipeBackResults.fail\n                    })}\n                    key={panelId}\n                    id={`panel-header-${panelId}`}\n                  >\n                    <div\n                      className=\"PanelHeader__bg\"\n                      key={panelId}\n                      id={`header-bg-${panelId}`}\n                      style={headerSwipeStyles.bg}\n                    />\n                    <div className=\"PanelHeader__container\">\n                      <div className=\"PanelHeader__left\">\n                        <div\n                          className=\"PanelHeader__left-in\"\n                          id={`header-left-${panelId}`}\n                          style={headerSwipeStyles.left}\n                        />\n                        {platform === IOS &&\n                        <div\n                          className=\"PanelHeader__addon\"\n                          id={`header-addon-${panelId}`}\n                          style={headerSwipeStyles.addon}\n                        />\n                        }\n                      </div>\n                      <div\n                        className=\"PanelHeader__content\"\n                        style={headerSwipeStyles.title}\n                        id={`header-title-${panelId}`}\n                      />\n                      <div\n                        className=\"PanelHeader__right\"\n                        id={`header-right-${panelId}`}\n                        style={headerSwipeStyles.right}\n                      />\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n        <div className=\"View__panels\">\n          {panels.map(panel => {\n            const panelId = panel.props.id;\n\n            return (\n              <div\n                className={classNames('View__panel', {\n                  'View__panel--active': panelId === activePanel,\n                  'View__panel--prev': panelId === prevPanel,\n                  'View__panel--next': panelId === nextPanel,\n                  'View__panel--swipe-back-prev': panelId === swipeBackPrevPanel,\n                  'View__panel--swipe-back-next': panelId === swipeBackNextPanel,\n                  'View__panel--swipe-back-success': swipeBackResult === SwipeBackResults.success,\n                  'View__panel--swipe-back-failed': swipeBackResult === SwipeBackResults.fail\n                })}\n                style={this.calcPanelSwipeStyles(panelId)}\n                key={panelId}\n              >\n                <div className=\"View__panel-in\">\n                  {panel}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        {hasPopout && <div className=\"View__popout\">{popout}</div>}\n        {hasModal && <div className=\"View__modal\">{modal}</div>}\n      </Touch>\n    );\n  }\n}\n\nexport default withPlatform(View);\n"]},"metadata":{},"sourceType":"module"}